@using GroupProj1Weddit.Models.ViewModels;
@model List<PostViewModel> // skickade fel typ av model, ska vara list ej topic model
@{
    ViewData["Title"] = "Posts";
}
@{
    int someVariable = (int)ViewBag.SomeVariable;
}

<h2>Posts in this topic</h2>

@if (Model.Any())
{
    <table class="table">
        <tbody>
            @foreach (var post in Model)
            {
                <tr>
                    <td>
                        <a href="@Url.Action("Index", "Comments", new { id = post.Id })">@post.Title</a> @* Om listan är tom är post.Id null och ger error *@
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <button id="ToCreatePost" class="btn btn-primary" onclick="redirectToCreatePost(@Model.First().TopicId)">Go to create post</button>
}
else
{
    <p>No posts available.</p> //If satsen kommer runt det, men går inte att skapa ny post för topicen utan topcId
    <button id="ToCreatePost" class="btn btn-primary" onclick="redirectToCreatePost(@ViewBag.SomeVariable)">Go to create post</button>

}

<script>
    function redirectToCreatePost(TopicId) {
        var url = '@Url.Action("CreatePost", "Posts")' + '?id=' + TopicId;
        window.location.href = url;
    }
</script>
